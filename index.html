<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Module Global Var</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Dosis:wght@200..800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <main>
      <h1 id="page-title" class="dosis-500">Module vars persist subsequent calls</h1>
      <article>
        <div class="explanations dosis-300">
          <p>
            Exploring the persistency of variables that are defined in a module with
            module scope. When the module is first imported in <em>script.js</em>,
            the variable is initialised and then keeps that value until the page is
            reloaded (browser), or until the process is terminated (Node.js), because
            ES6 modules are <strong>cached</strong>!
          </p>
          <p>
            The script goes on doing some activities, and finally printing the value
            of the module-wide 'magicNumber' variable.
          </p>
          <p>
            The browser imports a second script (<em>scrip2.js</em>), which does some
            activities and finally prints the value of 'magicNumber', which has
            indeed the same value that was set to it by <em>script.js</em>. This
            shows that both <em>script.js</em> and <em>script2.js</em> have access to
            the same instance of the <em>myModule.js</em> that they are importing!
          </p>
          <p>
            This happens because modules are cached by the browser (until page
            re-load) - Node.js too caches modules (during the same process). This
            means that any file that re-imports the module during the same execution
            of the program has access to
            <strong>the same state</strong> in the module! The module state is
            reachable across different parts of the application, because, whenever
            you are importing a module, you are actually always re-importing
            <strong>the same instance</strong> of the module, i.e. the cached
            instance!
          </p>
          <p>
            If you want to maintain state across different page loads, an additional
            storage mechanism is needed, e.g. <em>local storage</em>.
          </p>
        </div>
        <p class="dosis-500">
          --> open the console to follow along with code execution...
        </p>
      </article>
    </main>
    <script src="./script.js" type="module"></script>
    <script src="./script2.js" type="module"></script>
  </body>
</html>
